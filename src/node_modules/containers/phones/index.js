import React, {Component} from "react"; 
import { connect } from "react-redux";
import {fetchPhones, loadMore, addToBasket, fetchCategories} from 'actions'
import {getPhones} from 'selectors'
import * as R from 'ramda'
import { Link } from "react-router-dom";
import Layout from 'containers/layout'

class Phones extends Component {
    componentDidMount() {
        this.props.fetchPhones()
        this.props.fetchCategories()
        
    }

    renderPhone (phone, index) {
        const shortDesription = `${R.take(70, phone.description)}...`
        const {addToBasket} = this.props
        return(
            <div className="col-sm-4 col-lg-5 col-md-4">
            <div classname ='justify-content-center container mt-6' key={index}>
                <div className='card p-2 bg-white'>
               
                    <img 
                        className='about-product text-center mt-2'
                        src ={phone.image}
                        alt={phone.name} 
                    />
                    <div className='about-product text-center mt-2'>
                        <h4>
                            <Link to ={`/phones/${phone.id}`}>
                                {phone.name}
                            </Link>
                        </h4>
                        <h5 className="text-center font-weight-bold">${phone.price}</h5>
                        <p>{shortDesription}</p>
                        
                        <p className="itemButton">
                           
                            <button className="btn btn-success" onClick={() => addToBasket(phone.id)}>
                                <img src="/images/cart-16.png" alt='cart'></img> 
                                Add to cart 
                                
                            </button>
                            <Link 
                                to ={`/phones/${phone.id}`}
                                className='btn btn-outline-secondary'
                            >
                                 <img src="/images/info-16.png" alt='cart'></img> 
                                More info
                            </Link>
                        </p>
                    </div>
                </div>
            </div>
            </div>
        )
    }

    render () {
        const {phones, loadMore} = this.props
        return (
            <Layout>
                <div className ='books row'>
                    {phones.map((phone, index) => this.renderPhone(phone, index))}
                </div>
                <div className="row">
                    <div className="col-md-10 d-flex justify-content-center">
                        <button onClick={loadMore} className="btn btn-outline-secondary">
                            Load more
                        </button>
                    </div>
                </div>
            </Layout>
        )
    }
}

const mapStateToProps = (state, ownProps) => ({
    phones: getPhones(state, ownProps)
  })
  

const mapDispatchToProps = {
    fetchPhones,
    loadMore,
    addToBasket,
    fetchCategories
}

export default connect(mapStateToProps, mapDispatchToProps) (Phones)